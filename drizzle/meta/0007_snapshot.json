{
  "id": "4f8ab7ab-6eb5-40ba-9578-a7028f4fdf64",
  "prevId": "efe0f911-6136-498e-b19c-fb429fa2b986",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.audit_log": {
      "name": "audit_log",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "bigserial",
          "primaryKey": true,
          "notNull": true
        },
        "entity": {
          "name": "entity",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "entity_id": {
          "name": "entity_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "field": {
          "name": "field",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "before": {
          "name": "before",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "after": {
          "name": "after",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "at": {
          "name": "at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "user_id": {
          "name": "user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.category_rules": {
      "name": "category_rules",
      "schema": "",
      "columns": {
        "category": {
          "name": "category",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "override_multiplier": {
          "name": "override_multiplier",
          "type": "numeric(10, 4)",
          "primaryKey": false,
          "notNull": false
        },
        "override_number_of_layers": {
          "name": "override_number_of_layers",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.price_cache": {
      "name": "price_cache",
      "schema": "",
      "columns": {
        "inputs_hash": {
          "name": "inputs_hash",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "sku": {
          "name": "sku",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "final_pvp": {
          "name": "final_pvp",
          "type": "numeric(12, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "breakdown": {
          "name": "breakdown",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "computed_at": {
          "name": "computed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "price_cache_sku_products_sku_fk": {
          "name": "price_cache_sku_products_sku_fk",
          "tableFrom": "price_cache",
          "tableTo": "products",
          "columnsFrom": [
            "sku"
          ],
          "columnsTo": [
            "sku"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.price_params": {
      "name": "price_params",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "smallint",
          "primaryKey": true,
          "notNull": true,
          "default": "1"
        },
        "ink_price": {
          "name": "ink_price",
          "type": "numeric(10, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "lamination_price": {
          "name": "lamination_price",
          "type": "numeric(10, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "cut_price": {
          "name": "cut_price",
          "type": "numeric(10, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "cut_factor": {
          "name": "cut_factor",
          "type": "numeric(10, 4)",
          "primaryKey": false,
          "notNull": true,
          "default": "0.25"
        },
        "rounding_step": {
          "name": "rounding_step",
          "type": "numeric(10, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "cost_method": {
          "name": "cost_method",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'latest'"
        },
        "default_tier": {
          "name": "default_tier",
          "type": "smallint",
          "primaryKey": false,
          "notNull": true
        }
      },
      "indexes": {},
      "foreignKeys": {
        "price_params_default_tier_tiers_id_fk": {
          "name": "price_params_default_tier_tiers_id_fk",
          "tableFrom": "price_params",
          "tableTo": "tiers",
          "columnsFrom": [
            "default_tier"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {
        "price_params_ink_price_non_negative": {
          "name": "price_params_ink_price_non_negative",
          "value": "\"price_params\".\"ink_price\" >= 0"
        },
        "price_params_lamination_price_non_negative": {
          "name": "price_params_lamination_price_non_negative",
          "value": "\"price_params\".\"lamination_price\" >= 0"
        },
        "price_params_cut_price_non_negative": {
          "name": "price_params_cut_price_non_negative",
          "value": "\"price_params\".\"cut_price\" >= 0"
        },
        "price_params_cut_factor_non_negative": {
          "name": "price_params_cut_factor_non_negative",
          "value": "\"price_params\".\"cut_factor\" >= 0"
        },
        "price_params_rounding_step_positive": {
          "name": "price_params_rounding_step_positive",
          "value": "\"price_params\".\"rounding_step\" > 0"
        },
        "price_params_cost_method_valid": {
          "name": "price_params_cost_method_valid",
          "value": "\"price_params\".\"cost_method\" = 'latest'"
        }
      },
      "isRLSEnabled": false
    },
    "public.products": {
      "name": "products",
      "schema": "",
      "columns": {
        "sku": {
          "name": "sku",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "category": {
          "name": "category",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "provider_id": {
          "name": "provider_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "cost_sqft": {
          "name": "cost_sqft",
          "type": "numeric(12, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "area_sqft": {
          "name": "area_sqft",
          "type": "numeric(10, 3)",
          "primaryKey": false,
          "notNull": true,
          "default": "1"
        },
        "active_tier": {
          "name": "active_tier",
          "type": "smallint",
          "primaryKey": false,
          "notNull": true
        },
        "override_multiplier": {
          "name": "override_multiplier",
          "type": "numeric(10, 4)",
          "primaryKey": false,
          "notNull": false
        },
        "override_number_of_layers": {
          "name": "override_number_of_layers",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "ink_enabled": {
          "name": "ink_enabled",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "lam_enabled": {
          "name": "lam_enabled",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "cut_enabled": {
          "name": "cut_enabled",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "sell_mode": {
          "name": "sell_mode",
          "type": "sell_mode",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'SQFT'"
        },
        "sheets_count": {
          "name": "sheets_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "active": {
          "name": "active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "deleted_at": {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "products_category_idx": {
          "name": "products_category_idx",
          "columns": [
            {
              "expression": "category",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "products_provider_idx": {
          "name": "products_provider_idx",
          "columns": [
            {
              "expression": "provider_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "products_active_tier_idx": {
          "name": "products_active_tier_idx",
          "columns": [
            {
              "expression": "active_tier",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "products_sell_mode_idx": {
          "name": "products_sell_mode_idx",
          "columns": [
            {
              "expression": "sell_mode",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "products_provider_id_providers_id_fk": {
          "name": "products_provider_id_providers_id_fk",
          "tableFrom": "products",
          "tableTo": "providers",
          "columnsFrom": [
            "provider_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "cascade"
        },
        "products_active_tier_tiers_id_fk": {
          "name": "products_active_tier_tiers_id_fk",
          "tableFrom": "products",
          "tableTo": "tiers",
          "columnsFrom": [
            "active_tier"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {
        "products_cost_sqft_non_negative": {
          "name": "products_cost_sqft_non_negative",
          "value": "\"products\".\"cost_sqft\" >= 0"
        },
        "products_area_sqft_positive": {
          "name": "products_area_sqft_positive",
          "value": "\"products\".\"area_sqft\" > 0"
        },
        "products_override_multiplier_positive": {
          "name": "products_override_multiplier_positive",
          "value": "(\"products\".\"override_multiplier\" IS NULL) OR (\"products\".\"override_multiplier\" > 0)"
        },
        "products_override_number_of_layers_non_negative": {
          "name": "products_override_number_of_layers_non_negative",
          "value": "(\"products\".\"override_number_of_layers\" IS NULL) OR (\"products\".\"override_number_of_layers\" >= 0)"
        },
        "products_sheets_count_non_negative": {
          "name": "products_sheets_count_non_negative",
          "value": "(\"products\".\"sheets_count\" IS NULL) OR (\"products\".\"sheets_count\" >= 0)"
        }
      },
      "isRLSEnabled": false
    },
    "public.providers": {
      "name": "providers",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "active": {
          "name": "active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "deleted_at": {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "last_update": {
          "name": "last_update",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "providers_name_unique": {
          "name": "providers_name_unique",
          "nullsNotDistinct": false,
          "columns": [
            "name"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.purchase_items": {
      "name": "purchase_items",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "purchase_id": {
          "name": "purchase_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "product_id": {
          "name": "product_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "qty": {
          "name": "qty",
          "type": "numeric(12, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "unit": {
          "name": "unit",
          "type": "purchase_unit",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "amount": {
          "name": "amount",
          "type": "numeric(12, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "linked": {
          "name": "linked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "applied_to_product": {
          "name": "applied_to_product",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "temp_width": {
          "name": "temp_width",
          "type": "numeric(10, 3)",
          "primaryKey": false,
          "notNull": false
        },
        "temp_height": {
          "name": "temp_height",
          "type": "numeric(10, 3)",
          "primaryKey": false,
          "notNull": false
        },
        "temp_uom": {
          "name": "temp_uom",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {
        "purchase_items_purchase_idx": {
          "name": "purchase_items_purchase_idx",
          "columns": [
            {
              "expression": "purchase_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "purchase_items_product_idx": {
          "name": "purchase_items_product_idx",
          "columns": [
            {
              "expression": "product_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "purchase_items_purchase_id_purchases_id_fk": {
          "name": "purchase_items_purchase_id_purchases_id_fk",
          "tableFrom": "purchase_items",
          "tableTo": "purchases",
          "columnsFrom": [
            "purchase_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "purchase_items_product_id_products_sku_fk": {
          "name": "purchase_items_product_id_products_sku_fk",
          "tableFrom": "purchase_items",
          "tableTo": "products",
          "columnsFrom": [
            "product_id"
          ],
          "columnsTo": [
            "sku"
          ],
          "onDelete": "no action",
          "onUpdate": "cascade"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {
        "purchase_items_qty_positive": {
          "name": "purchase_items_qty_positive",
          "value": "\"purchase_items\".\"qty\" > 0"
        },
        "purchase_items_amount_non_negative": {
          "name": "purchase_items_amount_non_negative",
          "value": "\"purchase_items\".\"amount\" >= 0"
        },
        "purchase_items_temp_width_positive": {
          "name": "purchase_items_temp_width_positive",
          "value": "(\"purchase_items\".\"temp_width\" IS NULL) OR (\"purchase_items\".\"temp_width\" > 0)"
        },
        "purchase_items_temp_height_positive": {
          "name": "purchase_items_temp_height_positive",
          "value": "(\"purchase_items\".\"temp_height\" IS NULL) OR (\"purchase_items\".\"temp_height\" > 0)"
        },
        "purchase_items_temp_uom_valid": {
          "name": "purchase_items_temp_uom_valid",
          "value": "(\"purchase_items\".\"temp_uom\" IS NULL) OR (\"purchase_items\".\"temp_uom\" IN ('in', 'cm'))"
        }
      },
      "isRLSEnabled": false
    },
    "public.purchases": {
      "name": "purchases",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "supplier_id": {
          "name": "supplier_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "invoice_no": {
          "name": "invoice_no",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "date": {
          "name": "date",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "currency": {
          "name": "currency",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'USD'"
        },
        "notes": {
          "name": "notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "purchases_supplier_id_providers_id_fk": {
          "name": "purchases_supplier_id_providers_id_fk",
          "tableFrom": "purchases",
          "tableTo": "providers",
          "columnsFrom": [
            "supplier_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "cascade"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tiers": {
      "name": "tiers",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "smallint",
          "primaryKey": true,
          "notNull": true
        },
        "mult": {
          "name": "mult",
          "type": "numeric(10, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "number_of_layers": {
          "name": "number_of_layers",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {
        "tiers_mult_positive": {
          "name": "tiers_mult_positive",
          "value": "\"tiers\".\"mult\" > 0"
        },
        "tiers_number_of_layers_non_negative": {
          "name": "tiers_number_of_layers_non_negative",
          "value": "\"tiers\".\"number_of_layers\" >= 0"
        },
        "tiers_id_range": {
          "name": "tiers_id_range",
          "value": "\"tiers\".\"id\" BETWEEN 1 AND 5"
        }
      },
      "isRLSEnabled": false
    }
  },
  "enums": {
    "public.purchase_unit": {
      "name": "purchase_unit",
      "schema": "public",
      "values": [
        "sqft",
        "sheet"
      ]
    },
    "public.sell_mode": {
      "name": "sell_mode",
      "schema": "public",
      "values": [
        "SQFT",
        "SHEET"
      ]
    }
  },
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}